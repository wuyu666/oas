<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="com.chinasofti.oas.mapper.IDepartmentMapper">
  		<resultMap id="results" type="department" >
  			<id column="did" property="did"/>
  			<result column="dnumber" property="dnumber"/>
  			<result column="dname" property="dname"/>
  			<collection column="pid" property="positions" ofType="position">
  				<id column="pid" property="pid"/>
  				<result column="pname" property="pname"/>
  			</collection>
  		</resultMap>
  		<select id="queryDepartment" resultMap="results">
  			select d.dnumber,d.dname,p.pname from t_department as d left join t_department_has_t_position as dp on d.did=dp.t_department_did left join t_position as p on dp.t_position_pid=p.pid 
  			<where>
  				<if test="dname!=null and !dname.equals('')">
  					and dname=#{dname}
  				</if>
  			</where>
  		</select>
  		<select id="insertDepartment" parameterType="department">
  			insert into t_department(dnumber,dname,d_pid) values(department.dnumber,department.dname,department.position.pid);
  		</select>
  		<select id="updateDepartment"></select>
  		<select id="deleteDepartment">
  			delete from t_department where id=#{_parameter}
  		</select>
  </mapper>